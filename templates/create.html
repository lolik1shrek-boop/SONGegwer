{% extends "base.html" %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∞–±{% endblock %}

{% block content %}
<div class="container">
    <div class="page-title">
        <h1>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∞–±</h1>
        <p>–°–æ–∑–¥–∞–π —Ç–∞–±—É–ª–∞—Ç—É—Ä—É –¥–ª—è –≥–∏—Ç–∞—Ä—ã</p>
    </div>
    
    <div class="form-container">
        <form method="POST" action="{{ url_for('create_tab') }}">
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏</label>
                <input type="text" name="title" class="form-input" placeholder="Master of Puppets" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                <input type="text" name="artist" class="form-input" placeholder="Metallica" required>
            </div>

            <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                <!-- –†–ï–î–ê–ö–¢–û–† (—Å–Ω–∏–∑—É –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä) -->
                <div>
                    <div class="form-group">
                        <label class="form-label">–†–µ–¥–∞–∫—Ç–æ—Ä —Ç–∞–±—É–ª–∞—Ç—É—Ä—ã (—Å—Ç—Ä–æ–∫–∏)</label>
                        <div style="background: #1a1a1a; border: 1px solid #3a3a3a; border-radius: 4px; padding: 15px; font-family: 'Courier New', monospace; color: #ddd;">
                            <div style="margin-bottom: 8px;">
                                <span style="color: #E99FCF; font-weight: 600;">e:</span>
                                <textarea name="string_e" class="form-input tab-string-input" placeholder="|---------|---------|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|---------|---------|---------|---------|</textarea>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <span style="color: #E99FCF; font-weight: 600;">B:</span>
                                <textarea name="string_b" class="form-input tab-string-input" placeholder="|---------|---------|---------|---------|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|---------|---------|---------|---------|</textarea>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <span style="color: #E99FCF; font-weight: 600;">G:</span>
                                <textarea name="string_g" class="form-input tab-string-input" placeholder="|---------|---------|---------|---------|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|---------|---------|---------|---------|</textarea>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <span style="color: #E99FCF; font-weight: 600;">D:</span>
                                <textarea name="string_d" class="form-input tab-string-input" placeholder="|-3-3-|-3-3-|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|</textarea>
                            </div>
                            <div style="margin-bottom: 8px;">
                                <span style="color: #E99FCF; font-weight: 600;">A:</span>
                                <textarea name="string_a" class="form-input tab-string-input" placeholder="|-3-3-|-3-3-|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|</textarea>
                            </div>
                            <div style="margin-bottom: 0;">
                                <span style="color: #E99FCF; font-weight: 600;">E:</span>
                                <textarea name="string_E" class="form-input tab-string-input" placeholder="|-1-1-|-1-1-|" style="width: calc(100% - 40px); margin-left: 5px; display: inline-block;">|-1-1-1-1-|-1-1-1-1-|-1-1-1-1-|-1-1-1-1-|</textarea>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Å–Ω–∏ (BPM)</label>
                        <input type="number" name="speed_bpm" class="form-input" min="30" max="300" value="120">
                        <small style="color:#999; display:block; margin-top:6px;">–£–∫–∞–∂–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –≤ —É–¥–∞—Ä–∞—Ö –≤ –º–∏–Ω—É—Ç—É (BPM). –û—Å—Ç–∞–≤—å—Ç–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî 120.</small>
                    </div>
                </div>

                <!-- –ù–∏–∂–Ω—è—è –æ–±–ª–∞—Å—Ç—å ‚Äî –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
                <div>
                    <label class="form-label" style="display: block; margin-bottom: 12px;">üì∫ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±—É–ª–∞—Ç—É—Ä—ã (—Å–Ω–∏–∑—É)</label>
                    <div style="background: #2a2a2a; border: 1px solid #3a3a3a; border-radius: 4px; padding: 15px; overflow-x: auto;">
                        <div class="tab-container">
                            <pre id="preview_block">e |---------|---------|---------|---------|
B |---------|---------|---------|---------|
G |---------|---------|---------|---------|
D |-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|
A |-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|-3-3-3-3-|
E |-1-1-1-1-|-1-1-1-1-|-1-1-1-1-|-1-1-1-1-|</pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button type="submit" class="btn" style="background: #E99FCF; color: #1a1a1a; flex: 1; font-weight: 600;">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞–±
                </button>
                <a href="{{ url_for('home') }}" class="btn btn-view" style="flex: 1; text-align: center;">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    const strings = ['e', 'b', 'g', 'd', 'a', 'E'];
    function buildPreview() {
        const lines = strings.map(s => {
            const el = document.querySelector(`[name="string_${s}"]`);
            const val = el && el.value ? el.value : `|---------|---------|---------|---------|`;
            const label = s === 'E' ? 'E' : s; // preserve letter case
            return `${label} ${val}`;
        });
        document.getElementById('preview_block').textContent = lines.join('\n');
    }

    strings.forEach(str => {
        const input = document.querySelector(`[name="string_${str}"]`);
        if (input) {
            input.addEventListener('input', buildPreview);
        }
    });
    // initialize
    buildPreview();
</script>
{% endblock %}