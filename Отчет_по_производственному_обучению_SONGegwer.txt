Колледж ТОО "Astana IT University"

Отчёт
по производственному обучению
_________________________________________________
Наименование модуля: Разработка веб-приложения "SONGegwer"

Группа: ПО2207
ФИО студента: _______________________________________
ФИО руководителя/преподавателя: ____________________

г. Астана

Содержание

Введение ........................................... 3
1. Дизайн и архитектура проекта .................... 4
1.1. Требования и назначение ........................ 4
1.2. Структура проекта и файлы ........................ 5
2. Технологии и инструменты ........................ 7
3. Реализация (основные компоненты) ............... 9
3.1. Модель данных .................................. 9
3.2. Маршруты и представления ........................ 10
3.3. Шаблоны и статические файлы .................... 11
3.4. Особенности реализации (аватар, подписки) .... 12
4. Развёртывание и запуск .......................... 13
5. Эксплуатация и управление данными ............... 14
Заключение ......................................... 15
Список использованных источников .................. 16
Приложения ......................................... 17


Введение

Цель данного отчёта — документально зафиксировать процесс разработки и реализации учебного проекта "SONGegwer": небольшого веб-приложения для хранения, просмотра и совместного использования табулатур/аккордов. В отчёте описаны требования и дизайн, применённые технологии и инструменты, структура проекта, ключевые места реализации и инструкции по запуску и эксплуатации.

1. Дизайн и архитектура проекта

1.1. Требования и назначение

- Предоставить веб-интерфейс для добавления/просмотра/редактирования музыкальных табулатур (табов).
- Авторизация пользователей и управление их профилями.
- Публичные профили пользователей, отображение автора таба (ник, аватар) на странице таба.
- Внутренний механизм «Follow» (подписки) — подписаться/отписаться от другого пользователя, показывать счётчики "Followers"/"Following".
- Поддержка загрузки аватаров (и дефолтного изображения, если пользователь не загрузил аватар).
- Использование PostgreSQL в качестве СУБД.
- Минимально необходимая безопасность: защита форм CSRF, минимальная валидация вводимых данных.

1.2. Структура проекта и файлы

Проект расположен в каталоге `SONGegwer`. Ключевые файлы и директории:

- `app.py` — основной Flask-приложение; определяет маршруты (routes), создаёт контекст приложения и подключение к базе.
- `models.py` — SQLAlchemy-модели: `User`, `Tab` и ассоциативные таблицы (например, для подписок).
- `db.py` — вспомогательные утилиты для соединения с базой (при наличии).
- `requirements.txt` — файл зависимостей Python.
- `templates/` — каталог Jinja2-шаблонов:
  - `base.html`, `index.html`, `tab.html`, `create.html`, `edit.html`, `account.html`, `user_profile.html`, `tabs.html` и т.д.
- `static/` — статические файлы (CSS, изображения, загруженные аватары):
  - `style.css` — стили сайта.
  - `icon_account.png` — дефолтный аватар.
  - `uploads/` — загруженные пользователями файлы (аватары, возможно табы).
- Вспомогательные скрипты (по необходимости): скрипты для добавления демо-данных, очистки и т.д.

2. Технологии и инструменты

- Язык разработки: Python (версии 3.8+ рекомендуется, проверить используемую в окружении).
- Веб-фреймворк: Flask — лёгкий микрофреймворк для маршрутизации и рендеринга шаблонов.
- ORM: SQLAlchemy (и подключаемый поверх него Flask-SQLAlchemy) для описания моделей и работы с PostgreSQL.
- СУБД: PostgreSQL — надёжная реляционная база данных.
- Шаблонизатор: Jinja2 — входящая в состав Flask.
- Веб-стили: CSS (файл `static/style.css`).
- Среда разработки: виртуальное окружение `venv` (рекомендуется).
- Клиентские инструменты: браузер для тестирования; при необходимости — pgAdmin/psql для работы с БД.

3. Реализация (основные компоненты)

3.1. Модель данных

Основные сущности:

- `User`:
  - Поля: `id`, `username`, `password_hash`, `email` (опционально), `avatar_filename` и т.д.
  - Отношения: связи с `Tab` (один-ко-многим), связь self-referential для подписок (`followers` / `following`).

- `Tab`:
  - Поля: `id`, `title`, `artist`, `content` (текст таба), `owner_id`, `created_at`, `updated_at` и т.д.
  - Отношения: `owner` — внешний ключ на модель `User`.

- Ассоциативная таблица `followers_table` (self-referential many-to-many) — хранит пары (follower_id, followed_id).

3.2. Маршруты и представления

Основные маршруты приложения:

- `/` — главная страница со списком табов (`index.html`).
- `/tab/<int:tab_id>` — страница отдельного таба (`tab.html`), показывает содержимое, автора (ник и аватар), ссылку на профиль автора.
- `/create` — форма создания нового таба (`create.html`).
- `/edit/<int:tab_id>` — редактирование существующего таба (`edit.html`).
- `/account` — личный кабинет пользователя (`account.html`) с вкладками: "My Tabs", "Followers", "Following".
- `/user/<int:user_id>` — публичный профиль пользователя (`user_profile.html`) с кнопкой "Follow"/"Unfollow".
- `/toggle_follow/<int:user_id>` — POST-роут для переключения статуса подписки между текущим пользователем и указанным.
- Роуты для загрузки аватаров и статических файлов.

3.3. Шаблоны и статические файлы

- `base.html` — базовый шаблон с навигацией, где показывается имя пользователя и аватар (если нет — используется `static/icon_account.png`).
- `tab.html` — шаблон для отображения отдельного таба: заголовок, автор (с аватаром и ссылкой на профиль), текст таба.
- `user_profile.html` — публичный профиль с кнопкой подписки и списком табов пользователя.
- `account.html` — личный кабинет с вкладками: список собственных табов, подписчики и подписки; форма для follow/unfollow реализована как POST-запросы (возможна AJAX-реализация для удобства).
- `style.css` содержит классы для кнопок подписки (`.btn-follow`, `.btn-follow.following`) и другие базовые стили.

3.4. Особенности реализации

- Дефолтный аватар: для пользователей без загруженного `avatar_filename` в шаблонах используется `static/icon_account.png`.
- Подписки: реализованы через self-referential many-to-many таблицу (followers). Роут `toggle_follow` добавляет или удаляет запись.
- Безопасность форм: рекомендуется использовать `Flask-WTF` или иные CSRF-защиты; в текущей реализации — по возможности включены CSRF-токены.
- Дубликаты таблиц/записей: в утилитных SQL-скриптах предусмотрены примеры удаления дублей (использование оконной функции ROW_NUMBER() и т.п.).

4. Развёртывание и запуск

Минимальные шаги для локального запуска (Windows / PowerShell):

1) Создать и активировать виртуальное окружение (если ещё не создано):

```powershell
python -m venv venv
& .\venv\Scripts\Activate.ps1
```

2) Установить зависимости:

```powershell
pip install -r requirements.txt
```

3) Настроить переменные окружения (опционально) и убедиться, что PostgreSQL запущен и доступен. В `app.py` или в конфигурации указана строка подключения к БД, например:

postgresql://postgres:1234@localhost:5432/songegwer

4) Создать структуру БД (если используется `db.create_all()` для разработки) либо применить миграции (рекомендую настроить Alembic/Flask-Migrate для миграций):

```powershell
python -c "from app import db, create_app; app=create_app(); app.app_context().push(); db.create_all()"
```

5) Запустить приложение:

```powershell
python app.py
```

При возникновении проблем с импортом SQLAlchemy на Windows — выполнить простую диагностику импорта в интерактивной консоли Python, проверить версии пакетов и, при необходимости, использовать WSL/другую среду.

5. Эксплуатация и управление данными

- Резервные копии: использовать `pg_dump` для резервного копирования базы:

```powershell
pg_dump -U postgres -h localhost -p 5432 -F c -b -v -f "backup_songegwer.dump" songegwer
```

- Очистка дубликатов: примеры SQL-запросов содержатся в вспомогательных скриптах; для удаления дубликатов следует предварительно сделать SELECT с оконной функцией ROW_NUMBER(), затем удалить записи с номером > 1.

- Просмотр таблиц и содержимого в `psql` или `pgAdmin`: `\dt` (psql), `SELECT * FROM tabs LIMIT 50;` и т.д.

Заключение

В ходе производственного обучения разработан прототип веб-приложения "SONGegwer", реализующий основные функции управления табулатурами, профилями пользователей и системой подписок. Приложение использует стабильный стек (Flask + SQLAlchemy + PostgreSQL) и имеет понятную структуру проекта и шаблонов, что облегчает дальнейшее расширение функциональности (комментарии, рейтинг, AJAX-интерфейсы и т.д.).

Рекомендации по продолжению работы:
- Добавить систему миграций (Alembic / Flask-Migrate) для безопасной эволюции схемы БД.
- Сделать операции follow/unfollow асинхронными (AJAX) для более плавного интерфейса.
- Реализовать полноценно регистрацию пользователей, восстановление пароля и валидацию ввода.
- Настроить автоматические тесты и единичные тесты для критичных частей (модели, маршруты).

Список использованных источников

1. Документация Flask — https://flask.palletsprojects.com/
2. Документация SQLAlchemy — https://docs.sqlalchemy.org/
3. Документация PostgreSQL — https://www.postgresql.org/docs/
4. Документация Jinja2 — https://jinja.palletsprojects.com/

Приложения

Приложение A — Список ключевых файлов проекта:
- `app.py`
- `models.py`
- `db.py` (если присутствует)
- `requirements.txt`
- `templates/` (см. перечисление выше)
- `static/` (см. перечисление выше)
- Вспомогательные скрипты: `add_demo_tabs.py`, `delete_all_users_psql.py` и др. (при наличии)

Приложение B — Инструкции по быстрому тестированию основных функций:
- Создать тестового пользователя (через регистрационную форму или напрямую в БД).
- Залогиниться, создать несколько табов, проверить публичный профиль и отображение автора на странице таба.
- Создать ещё одного пользователя и выполнить подписку/отписку через публичный профиль.
- Проверить, что у пользователей без аватара отображается `static/icon_account.png`.


Дата создания отчёта: 10.12.2025


(Документ сгенерирован автоматически на основе структуры и содержимого проекта `SONGegwer`. Для расширения отчёта можно добавить подробные схемы базы данных, экспорт структуры таблиц и примеры SQL-запросов.)